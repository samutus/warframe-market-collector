<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>WFM – Sets Prime (ROI)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'ui-sans-serif', 'system-ui'] }
        }
      }
    }
  </script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
  <!-- Optional tiny CSS (most styling via Tailwind) -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-slate-50 text-slate-900">
  <div id="app" class="grid grid-cols-1 lg:grid-cols-2 h-[100svh]">
    <!-- Left: list -->
    <aside id="left" class="border-slate-200 border-r p-3 overflow-auto bg-white/60">
      <div class="flex gap-2 mb-3">
        <div class="relative flex-1">
          <input id="search" type="text" placeholder="Rechercher un set prime…"
                 class="w-full rounded-xl border border-slate-300 bg-white px-3 py-2 pe-8 outline-none focus:ring-2 focus:ring-sky-300 focus:border-sky-400 placeholder:text-slate-400" />
          <svg class="absolute right-2 top-2.5 h-5 w-5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"/>
          </svg>
        </div>
        <div class="flex items-center gap-2">
          <select id="sort"
                  class="rounded-xl border border-slate-300 bg-white px-3 py-2 outline-none focus:ring-2 focus:ring-sky-300 focus:border-sky-400">
            <option value="roi">Trier par ROI%</option>
            <option value="margin">Trier par Marge</option>
            <option value="kpi">Trier par KPI (0–100)</option>
            <option value="volume">Trier par Volume</option>
          </select>
          <button id="sortDirBtn" class="rounded-xl border border-slate-300 bg-white px-2 py-2 w-10 h-10 grid place-items-center hover:bg-slate-50 focus:ring-2 focus:ring-sky-300 focus:border-sky-400" title="Basculer tri croissant/décroissant" aria-label="Tri croissant ou décroissant">
            <svg id="sortDirIcon" class="h-5 w-5 transition-transform text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l5-5 5 5" />
            </svg>
          </button>
        </div>

      </div>

      <!-- Table (virtual grid) -->
      <div id="itemTable" class="grid auto-rows-min"></div>
    </aside>

    <!-- Right: detail -->
    <main id="right" class="p-4 overflow-auto">
      <h2 id="itemTitle" class="text-2xl font-semibold tracking-tight">Sélectionne un set</h2>
      <div id="meta" class="mt-2 text-sm text-slate-600"></div>

      <!-- Parts -->
      <section id="partsSection" class="mt-4">
        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm">
          <div class="px-4 py-3 border-b border-slate-100">
            <h3 class="font-semibold">Pièces requises (dernier snapshot)</h3>
          </div>
          <div id="partsTable" class="px-2 py-2 overflow-x-auto"></div>
        </div>
      </section>

      <!-- Charts -->
      <section class="mt-4 grid grid-cols-1 gap-4">
        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm">
          <div class="px-4 py-3 border-b border-slate-100">
            <h3 class="font-semibold">Prix (médian journalier)</h3>
          </div>
          <div class="p-4">
            <div class="w-full h-64 md:h-72">
              <canvas id="priceChart" class="w-full h-full"></canvas>
            </div>
          </div>
        </div>

        <div class="rounded-2xl border border-slate-200 bg-white shadow-sm">
          <div class="px-4 py-3 border-b border-slate-100">
            <h3 class="font-semibold">Profondeurs (médian journalier)</h3>
          </div>
          <div class="p-4">
            <div class="w-full h-64 md:h-72">
              <canvas id="depthChart" class="w-full h-full"></canvas>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
